{"version":3,"file":"ractive-window.js","sources":["../src/index.js","../src/host.js","../src/window.js"],"sourcesContent":["import Window from \"window\";\nimport Host from \"host\";\n\nvar res = {\n  \"Window\": Window,\n  \"WindowHost\": Host\n};\n\nexport default res;\n","/* global Ractive */\n\nimport Window from \"window\";\n\nvar messageButtons = {\n  ok: { label: 'OK', action: function() { this.result = 'ok'; this.close(); }, position: 'middle' },\n  cancel: { label: 'Cancel', action: function() { this.result = 'cancel'; this.close(); }, position: 'middle' },\n  yes: { label: 'Yes', action: function() { this.result = 'yes'; this.close(); }, position: 'middle' },\n  no: { label: 'No', action: function() { this.result = 'no'; this.close(); }, position: 'middle' }\n};\n\nvar WindowHost;\nWindowHost = (function() {\n  var counter = 0;\n\n  // creates a window by appending to the slot array and retrieving the added window component\n  // the callback is called first, if supplied\n  // the window is then rendered and has its activate function called, if it has one\n  // the window is then cascaded if it isn't already positioned\n  function newWindow(e, cb) { // e can be an event or the callback. the callback (cb) is optional\n    var current = counter;\n    counter += 1;\n    var host = this;\n    return host.push('windowSlots', current).then(function() {\n      var pr;\n\n      // find the window instance let it know who it is\n      var wnds = host.findAllComponents('Window');\n      var wnd = wnds[wnds.length - 1];\n\n      host.set('windows.' + current, wnd);\n      wnd.parentNumber = current;\n      wnd.set({\n        'geometry.index': 1000 + wnds.length,\n        'geometry.left': -9999,\n        'geometry.top': -9999,\n        'id': current\n      });\n\n      // call the creation callback if given\n      var step1 = function() {\n        var mpr;\n        if (!!cb && typeof(cb) === 'function') {\n          try {\n            mpr = cb(wnd);\n            if (!!mpr && typeof mpr.then === 'function') return mpr;\n          } catch (e1) { console.log(e1); }\n        } else if (typeof(e) === 'function') {\n          try {\n            mpr = e(wnd);\n            if (!!mpr && typeof mpr.then === 'function') pr = mpr;\n          } catch (e2) { console.log(e2); }\n        }\n      };\n      pr = step1();\n\n      // render the window and call its activate function\n      var step2 = function() {\n        var mpr;\n        wnd.raise();\n        return wnd.set('_wnd_rendered', true).then(function() {\n          wnd.element = wnd.find('.ractive-window');\n          try {\n            mpr = wnd.activated();\n            if (!!mpr && typeof mpr.then === 'function') return mpr;\n          } catch (e4) { console.log(e4); }\n        });\n      };\n      if (!!pr) pr = pr.then(step2); else pr = step2();\n\n      // move the window from initial offscreen coordinates\n      var step3 = function() {\n        var mpr;\n        if (wnd.get('geometry.left') === -9999) {\n          return wnd.move('cascade').then(() => wnd);\n        }\n        return wnd;\n      };\n      if (!!pr) pr = pr.then(step3); else pr = step3();\n\n      // return a promise for the last steps completion\n      return pr;\n    });\n  }\n\n  // shows a centered modal messagebox\n  function messageBox(opts) {\n    var args = arguments;\n    var host = this;\n    return new Ractive.Promise(function(y) {\n      host.newWindow(function(w) {\n        var message;\n        if (args.length >= 2) {\n          message = args[0];\n          opts = args[1];\n        } else if (args.length === 1 && typeof args[0] === 'string') {\n          message = args[0];\n          opts = {};\n        }\n\n        w.set('title', opts.title || 'Message');\n        w.set('resizable', false);\n        w.controls('close');\n        w.content(message);\n        var btns = opts.buttons || ['ok'], out = [];\n        for (var i = 0; i < btns.length; i++) if (messageButtons.hasOwnProperty(btns[i])) out.push(messageButtons[btns[i]]);\n        w.buttons(out);\n        w.onClose = function() {\n          this.kill();\n          y(w.result || 'none');\n        };\n        if (!opts.hasOwnProperty('modal') || opts.modal) host.set('globalBlock', w);\n        w.activated = function() { w.move('center'); };\n      });\n    });\n  }\n\n  return Ractive.extend({\n    isolated: true,\n    defaults: {\n      control: {\n        label: function label(control, lbl) { Window.partials[control + 'ControlLabel'] = lbl; }\n      },\n      controls: function() {\n        var partial = '';\n        for (var i = 0; i < arguments.length; i++) {\n          partial += '{{>' + arguments[i] + 'Control}}';\n        }\n        Window.partials.controls = partial;\n      }\n    },\n    components: { Window: Window },\n    data: { windowSlots: [], windows: {}, blocks: {}, globalBlock: null },\n    computed: { blocked: function() { return !!this.get('globalBlock'); } },\n    template: \"<div class='ractive-window-host-modal' style='{{^blocked}}display: none;{{/blocked}}'></div><div class='host-content'>{{yield}}</div>{{#windowSlots}}<Window/>{{/windowSlots}}\",\n    newWindow: newWindow,\n    killWindow: function(wnd) {\n      var blocks = this.get('blocks');\n      var wnds = this.get('windows');\n      var topWnd, topIdx = -1, i;\n      if (!!wnds) {\n        for (var w in wnds) {\n          if (wnds[w] === wnd) delete wnds[w];\n          else {\n            i = wnds[w].get('geometry.index');\n            if (i > topIdx) {\n              topIdx = i;\n              topWnd = wnds[w];\n            }\n          }\n        }\n        if (topWnd && !topWnd.get('topmost')) topWnd.set('topmost', true);\n      }\n      var slots = this.get('windowSlots');\n      if (!!slots) {\n        this.splice('windowSlots', slots.indexOf(wnd.parentNumber), 1);\n      }\n      for (i in blocks) {\n        var arr = blocks[i];\n        if (!!arr && Array.isArray(arr) && arr.indexOf(wnd.parentNumber) >= 0) arr.splice(arr.indexOf(wnd.parentNumber), 1);\n      }\n      if (wnd === this.get('globalBlock')) this.set('globalBlock', null);\n      this.unblockUnblockedWindows();\n    },\n    raiseWindow: function(wnd) {\n      var wndso = this.get('windows');\n      var slots = this.get('windowSlots');\n      var blocks = this.get('blocks');\n      var wnds = [];\n      var target = this.topLevelBlockers(wnd);\n      target.push(wnd);\n\n      for (var k in wndso) if (target.indexOf(wndso[k]) < 0) wnds.push(wndso[k]);\n\n      // put windows in existing order in an array\n      wnds.sort(function(a, b) {\n        var ai = a.get('geometry.index'), bi = b.get('geometry.index');\n        if (ai < bi) return -1; else if (ai > bi) return 1; else return 0;\n      });\n\n      // add the window being raised to the end-o-the-queue\n      if (!!wnd) wnds = wnds.concat(target);\n\n      // move blocked windows to below their blocker with splice and indexOf\n      function moveBeforeBlocker(wnd, blockers) {\n        for (var i in blockers) {\n          var bl = wndso[blockers[i]];\n          var wi = wnds.indexOf(wnd), bi = wnds.indexOf(bl);\n          if (!!!bl || wi < 0 || bi < 0) continue;\n\n          // blocker must be moved first in case it too is blocked, so recursion required\n          var arr = blocks[bl.parentNumber];\n          if (!!!arr && Array.isArray(arr) && arr.length > 0) moveBeforeBlocker(bl, arr);\n          if (wi > bi) {\n            wnds.splice(wi, 1); // remove window\n            wnds.splice(bi, 0, wnd); // pop it in before bl\n          }\n        }\n      }\n\n      var i;\n      for (i in slots) {\n        var arr = blocks[slots[i]];\n        if (!!arr && Array.isArray(arr) && arr.length > 0) moveBeforeBlocker(wndso[slots[i]], arr);\n      }\n\n      // loop through array assigning indices\n      for (i in wnds) {\n        wnds[i].set('geometry.index', 1000 + (+i));\n        if (wnds[i] !== wnd) wnds[i].set('topmost', false);\n      }\n      if (!wnd.get('topmost')) wnd.set('topmost', true);\n\n      function globalBlocks(wnd) {\n        var res = [];\n        if (!!!wnd) return res;\n\n        var arr = blocks[wnd.parentNumber];\n        if (!!arr && Array.isArray(arr) && arr.length > 0) {\n          for (var i in arr) {\n            res = res.concat(globalBlocks(wndso[arr[i]]));\n          }\n        }\n\n        res.push(wnd);\n\n        return res;\n      }\n\n      // if globalBlock is set, add 10000 to it and all of its blockers\n      var globals = globalBlocks(this.get('globalBlock'));\n      for (i in globals) globals[i].add('geometry.index', 10000);\n    },\n    topLevelBlockers: function(wnd) {\n      if (!!!wnd) return [];\n\n      var blocks = this.get('blocks');\n      var wndso = this.get('windows');\n      var arr = blocks[wnd.parentNumber];\n      var res = [];\n\n      if (!!!arr || !Array.isArray(arr) || arr.length === 0) return res;\n\n      for (var i in arr) {\n        var arr2 = blocks[arr[i]];\n        if (!!!arr2 || !Array.isArray(arr2) || arr2.length === 0) res.push(wndso[arr[i]]);\n        else {\n          res = res.concat(this.topLevelBlockers(wndso[arr[i]]));\n        }\n      }\n\n      return res;\n    },\n    blockWindow: function(target, blocker /*, ...*/) {\n      if (!!!target || !!!blocker) return;\n\n      var blocks = this.get('blocks');\n      var arr = blocks[target.parentNumber];\n      if (!!!arr || !Array.isArray(arr)) arr = [];\n      if (arr.indexOf(blocker.parentNumber) < 0) arr.push(blocker.parentNumber);\n      blocks[target.parentNumber] = arr;\n      for (var i = 2; i < arguments.length; i++) {\n        if (arr.indexOf(arguments[i].parentNumber) < 0) arr.push(arguments[i].parentNumber);\n      }\n      if (arr.length > 0) target.set('blocked', true);\n      this.raiseWindow();\n    },\n    unblockWindow: function(target, blocker /*, ...*/) {\n      if (!!!target | !!!blocker) return;\n\n      var blocks = this.get('blocks');\n      var arr = blocks[target.parentNumber];\n      if (!!!arr || !Array.isArray(arr)) return;\n      if (arr.indexOf(blocker.parentNumber) >= 0) arr.splice(arr.indexOf(blocker.parentNumber), 1);\n      for (var i = 2; i < arguments.length; i++) {\n        if (arr.indexOf(arguments[i].parentNumber) >= 0) arr.splice(arr.indexOf(arguments[i].parentNumber), 1);\n      }\n      if (arr.length === 0) target.set('blocked', false);\n      this.raiseWindow();\n    },\n    unblockUnblockedWindows: function() {\n      var blocks = this.get('blocks');\n      var wndso = this.get('windows');\n      for (var i in blocks) {\n        var arr = blocks[i];\n        if (!!!arr || !Array.isArray(arr) || arr.length === 0) {\n          var wnd = wndso[i];\n          if (!!wnd) wnd.set('blocked', false);\n        }\n      }\n    },\n    messageBox: messageBox\n  });\n})();\n\nexport default WindowHost;\n","/* global Ractive */\n\nvar template =\n`{{#_wnd_rendered}}<div id='ractive-window-{{.id}}' class='ractive-window{{#(.buttons.length > 0)}} with-buttons{{/}}{{#.resizable}} resizable{{else}} fixed{{/}}{{#.geometry.state === 2}} maximized{{/}}{{#.class.window}} {{.class.window}}{{/}}{{#.topmost}} topmost{{/}}' on-click='_raise' style='{{#.hidden}}display: none;{{/}}top: {{.geometry.top}}px; left: {{.geometry.left}}px; {{#(.resizable || .geometry.state === 2)}}width: {{.geometry.width}}{{.geometry.dwunit}}; height: {{.geometry.height}}{{.geometry.dhunit}}; {{/}}z-index: {{.geometry.index}};{{#.style.window}} {{.style.window}}{{/}}'>\n  <div class='rw-modal' on-mousedown='_moveStart' style='{{^.blocked}}display: none;{{/}}'></div>\n  <div class='rw-interior'>\n    <div class='rw-controls'>{{>controls}}</div>\n    <div class='rw-title' on-touchstart-mousedown='_moveStart' on-dblclick='_restore'>{{>title}}</div>\n    <div class='rw-body{{#.class.body}} {{.class.body}}{{/}}' {{#.style.body}}style='{{.style.body}}'{{/}}>{{>body}}</div>\n    {{#(.buttons.length > 0)}}<div class='rw-buttons'>{{>buttons}}</div>{{/}}\n    <div class='rw-resize-handle' on-touchstart-mousedown='_resizeStart'></div>\n    <div class='rw-foot'>{{>foot}}</div>\n  </div>\n</div>{{/}}`;\n\nvar Window;\nWindow = Ractive.extend({\n  template: template,\n  onconstruct: function(opts) {\n    var wnd = this;\n\n    var sx, sy;\n    var moveFn;\n    moveFn = function(e) {\n      var x, y;\n      e.preventDefault();\n      if (e.type.indexOf('touch') >= 0) {\n        x = +(e.changedTouches[0].clientX);\n        y = +(e.changedTouches[0].clientY);\n      } else {\n        x = +(e.x || e.clientX);\n        y = +(e.y || e.clientY);\n      }\n\n      wnd.move(+wnd.get('geometry.left') + x - +sx, +wnd.get('geometry.top') + y - +sy);\n      sx = x;\n      sy = y;\n      if (e.type === 'mouseup' || e.type === 'touchend') {\n        document.removeEventListener('mousemove', moveFn, false);\n        document.removeEventListener('mouseup', moveFn, false);\n        document.removeEventListener('touchmove', moveFn, false);\n        document.removeEventListener('touchend', moveFn, false);\n      }\n    };\n    wnd.on('_moveStart', function(e) {\n      if ((e.original.type === 'mousedown' && e.original.button === 0) || e.original.type === 'touchstart') {\n        wnd.restore();\n        if (e.original.type.indexOf('touch') >= 0) {\n          sx = +(e.original.changedTouches[0].clientX);\n          sy = +(e.original.changedTouches[0].clientY);\n        } else {\n          sx = +(e.original.x || e.original.clientX);\n          sy = +(e.original.y || e.original.clientY);\n        }\n        document.addEventListener('mousemove', moveFn);\n        document.addEventListener('mouseup', moveFn);\n        document.addEventListener('touchmove', moveFn);\n        document.addEventListener('touchend', moveFn);\n        e.original.preventDefault();\n      }\n    });\n\n    var resizeFn;\n    resizeFn = function(e) {\n      var x, y;\n      e.preventDefault();\n      if (e.type.indexOf('touch') >= 0) {\n        x = e.changedTouches[0].clientX;\n        y = e.changedTouches[0].clientY;\n      } else {\n        x = +(e.x || e.clientX);\n        y = +(e.y || e.clientY);\n      }\n      var w = +wnd.get('geometry.width') + (x - +sx);\n      var h = +wnd.get('geometry.height') + (y - +sy);\n      wnd.resize(w, h);\n      sx = x;\n      sy = y;\n      if (e.type === 'mouseup' || e.type === 'touchend') {\n        document.removeEventListener('mousemove', resizeFn, false);\n        document.removeEventListener('mouseup', resizeFn, false);\n        document.removeEventListener('touchmove', resizeFn, false);\n        document.removeEventListener('touchend', resizeFn, false);\n      }\n    };\n    wnd.on('_resizeStart', function(e) {\n      if ((e.original.type == 'mousedown' && e.original.button === 0) || e.original.type === 'touchstart') {\n        wnd.restore();\n        if (e.original.type.indexOf('touch') >= 0) {\n          sx = e.original.changedTouches[0].clientX;\n          sy = e.original.changedTouches[0].clientY;\n        } else {\n          sx = (e.original.x || e.original.clientX);\n          sy = (e.original.y || e.original.clientY);\n        }\n        document.addEventListener('mousemove', resizeFn);\n        document.addEventListener('mouseup', resizeFn);\n        document.addEventListener('touchmove', resizeFn);\n        document.addEventListener('touchend', resizeFn);\n      }\n    });\n\n    var stateFn = function(target, e) {\n      switch (target) {\n        case 'min': wnd.minimize(); break;\n        case 'max': wnd.maximize(); break;\n        case 'normal': wnd.restore(); break;\n        default: break;\n      }\n    };\n\n    wnd.on('_minimize', function(e) { stateFn('min', e); });\n    wnd.on('_restore', function(e) {\n      switch (wnd.get('geometry.state')) {\n        case 0: stateFn('max', e); break;\n        case 1:\n          case 2:\n          stateFn('normal', e); break;\n        default: break;\n      }\n    });\n    wnd.on('_raise', function(e) { wnd.raise(); });\n    wnd.on('_close', function(e) { wnd.close(); });\n    wnd.on('_dialog-button', function(e) {\n      var fn = e.context.action;\n      if (!!fn && typeof fn === 'function') fn.call(this);\n    });\n\n    wnd.result = null;\n    wnd.waitForClose = wnd.afterClose = new Ractive.Promise(function(y, n) {\n      var fn = function(t) {\n        return function(v) {\n          wnd.completeAfterClose = null;\n          wnd.rejectAfterClose = null;\n          t(v);\n        };\n      };\n      wnd.completeAfterClose = fn(y);\n      wnd.rejectAfterClose = fn(n);\n    });\n  },\n  onrender() {\n    if (!!!this.get('buttonClass') && !!this.parent.get('buttonClass')) {\n      this.set('buttonClass', this.parent.get('buttonClass'));\n    }\n\n    this.watchers = this.observe({\n      title: (n, o) => {\n        this.fire('retitle', n, this);\n      },\n\n      'geometry.state': (n, o) => {\n        switch (n) {\n          case 0: this.fire('restore', n, this); break;\n          case 1: this.fire('minimize', n, this); break;\n          case 2: this.fire('maximize', n, this); break;\n        }\n      }\n    });\n  },\n  onunrender() { if (this.watchers && typeof this.watchers.cancel === 'function') this.watchers.cancel(); },\n  activated() {},\n  data() { return {\n    _wnd_rendered: false,\n    blocked: false,\n    resizable: true,\n    geometry: {\n      top: -9999, left: -9999, width: 200, height: 200, state: 0, dwunit: 'px', dhunit: 'px', index: 1000,\n      minimum: { x: 0, y: 0, width: 70, height: 50 }\n    },\n    style: {},\n    class: {},\n    makePartial(key, template) {\n      if (!this._makePartial_templates) this._makePartial_templates = {};\n      if (this._makePartial_templates[key] != template) {\n        this.resetPartial(key, template);\n        this._makePartial_templates[key] = template;\n      }\n      return key;\n    }\n  }; },\n  partials: {\n    title: \"{{> ~/makePartial('titleTpl', .title) }}\",\n    body: '',\n    foot: '',\n    buttons: \"{{#.buttons:i}}<button on-click='_dialog-button' class='{{.position || ''}}{{#.buttonClass}} {{.buttonClass}}{{/}}{{#../../class.button}} {{../../class.button}}{{/}}' disabled='{{!.enabled}}'>{{> ~/makePartial('button' + i + 'Tpl', .label) }}</button>{{/}}\",\n    controls: '{{>minimizeControl}}{{>restoreControl}}{{>closeControl}}',\n    minimizeControl: \"<button on-click='_minimize' class='rw-minimize'>{{>minimizeControlLabel}}</button>\",\n    minimizeControlLabel: \"_\",\n    restoreControl: \"<button on-click='_restore' class='rw-restore'>{{>restoreControlLabel}}</button>\",\n    restoreControlLabel: \"^\",\n    closeControl: \"<button on-click='_close' class='rw-close'>{{>closeControlLabel}}</button>\",\n    closeControlLabel: \"X\"\n  },\n  rerender: function() {\n    var wnd = this;\n    if (!wnd.get('_wnd_rendered')) return Ractive.Promise.resolve('ok');\n    wnd.set('_wnd_rendered', false);\n    return this.set('_wnd_rendered', true);\n  },\n  title: function(str) { this.set('title', str); },\n  move: function(x, y) {\n    if (typeof x === 'string') {\n      switch (x) {\n        case 'center':\n          case 'centerScreen':\n          return this.set({\n          'geometry.top': (this.parent.el.clientHeight - this.element.clientHeight) / 2,\n          'geometry.left': (this.parent.el.clientWidth - this.element.clientWidth) / 2\n        });\n        case 'cascade':\n          return this.set({\n          'geometry.top': ((this.parentNumber % 10) * 20) + 10,\n          'geometry.left': ((this.parentNumber % 50) * 20) + 10\n        });\n      }\n      return Ractive.Promise.resolve(false);\n    }\n    y = +y;\n    x = +x;\n    var min = this.get('geometry.minimum');\n    var max = this.get('geometry.maximum');\n    var w = +this.get('geometry.width');\n    var h = +this.get('geometry.height');\n    if (!!max) {\n      if (x + w > +max.x) x = +max.x - x;\n      if (y + h > +max.y) y = +max.y - y;\n    }\n    if (!!min) {\n      if (x < +min.x) x = +min.x;\n      if (y < +min.y) y = +min.y;\n    }\n    return this.set({\n      'geometry.top': y,\n      'geometry.left': x\n    });\n  },\n  resize: function(w, h) {\n    w = getDimPx.call(this,'width', w);\n    h = getDimPx.call(this, 'height', h);\n    var min = this.get('geometry.minimum');\n    var max = this.get('geometry.maximum');\n    if (!!max) {\n      if (w > max.width) w = max.width;\n      if (w > max.height) w = max.height;\n    }\n    if (!!min) {\n      if (w < min.width) w = min.width;\n      if (h < min.height) h = min.height;\n    }\n    this.set({\n      'geometry.width': w,\n      'geometry.height': h\n    });\n  },\n  resizable: function(b) { this.set('resizable', b); },\n  minimize: function() {\n    var wnd = this;\n    if (wnd.get('geometry.state') !== 1) {\n      wnd.set({\n        hidden: true,\n        'geometry.state': 1\n      });\n      wnd.fire('minimized', { window: wnd });\n    }\n  },\n  maximize: function() {\n    var wnd = this;\n    if (wnd.get('geometry.state') !== 2) {\n      wnd.normalGeometry = { top: wnd.get('geometry.top'), left: wnd.get('geometry.left'), width: wnd.get('geometry.width'), height: wnd.get('geometry.height') };\n      wnd.set({\n        'hidden': false,\n        'geometry.left': 0,\n        'geometry.top': 0,\n        'geometry.width': 100,\n        'geometry.height': 100,\n        'geometry.dwunit': '%',\n        'geometry.dhunit': '%',\n        'geometry.state': 2\n      });\n      wnd.fire('maximized', { window: wnd });\n    }\n  },\n  restore: function() {\n    var wnd = this;\n    switch (wnd.get('geometry.state')) {\n      case 1: // minimized\n        wnd.set({\n          hidden: false,\n          'geometry.state': 0\n        });\n        break;\n      case 2:\n        var g = wnd.normalGeometry || {};\n        wnd.normalGeometry = null;\n        if (g.top < 0 || g.left < 0) {\n          g.top = 0;\n          g.left = 0;\n        }\n        wnd.set({\n          hidden: false,\n          'geometry.left': g.left,\n          'geometry.top': g.top,\n          'geometry.width': g.width,\n          'geometry.height': g.height,\n          'geometry.dwunit': 'px',\n          'geometry.dhunit': 'px',\n          'geometry.state': 0\n        });\n        break;\n      default: break;\n    }\n    this.raise();\n  },\n  raise: function() {\n    if (!!this.parent) this.parent.raiseWindow(this);\n  },\n  kill: function() {\n    var wnd = this;\n    this.fire('close', this);\n    if (!!wnd.parent) {\n      wnd.parent.killWindow(wnd);\n    } else {\n      wnd.teardown();\n    }\n    if (!!wnd.completeAfterClose) wnd.completeAfterClose(wnd.result);\n  },\n  content: function(ct) {\n    return this.resetPartial('body', ct);\n  },\n  buttons: function() {\n    var arr = [], i;\n    this.set('buttons', arr);\n    if (arguments.length === 1 && typeof arguments[0].length === 'number') {\n      arr = arguments[0];\n    } else {\n      for (i = 0; i < arguments.length; i++) {\n        arr.push(arguments[i]);\n      }\n    }\n    var left = [], right = [], middle = [];\n    for (i = 0; i < arr.length; i++) {\n      var b = arr[i];\n      if (!!b.position) {\n        if (b.position === 'left') left.push(b);\n        else if (b.position === 'right') right.push(b);\n        else if (b.position === 'middle') middle.push(b);\n        else if (b.position === 'center') middle.push(b);\n        else { right.push(b); b.position = 'right'; }\n      } else { right.push(b); b.position = 'right'; }\n      if (!b.hasOwnProperty('enabled')) b.enabled = true;\n    }\n    arr = [];\n    for (i = 0; i < left.length; i++) arr.push(left[i]);\n    for (i = right.length - 1; i >= 0; i--) arr.push(right[i]);\n    for (i = 0; i < middle.length; i++) arr.push(middle[i]);\n    this.set('buttons', arr);\n  },\n  button: function(name, cb) {\n    var arr = this.get('buttons');\n    var btn, i;\n    if (typeof name === 'number') { btn = arr[name]; i = name; }\n    else for (i = 0; i < arr.length; i++) {\n      if (arr[i].label === name) {\n        btn = arr[i];\n        break;\n      }\n    }\n\n    if (!!btn) {\n      cb(btn);\n      this.set('buttons.' + i, btn);\n    }\n  },\n  controls: function() {\n    var arr = [], i, str = '';\n    if (arguments.length === 1 && typeof arguments[0] !== 'string') arr = arguments[0];\n    else {\n      for (i = 0; i < arguments.length; i++) arr.push(arguments[i]);\n    }\n    for (i = 0; i < arr.length; i++) str += '{{>' + arr[i] + 'Control}}';\n    this.partials.controls = str;\n    return this.rerender();\n  },\n  onClose: function() {\n    this.kill();\n  },\n  close: function(fn) {\n    if (!!!fn) fn = this.onClose;\n    if (fn.length === 0) fn.call(this);\n    else {\n      var wnd = this;\n      fn.call(this, function(close) { if (close) wnd.kill(); });\n    }\n  }\n});\n\nvar cssUnit = /([\\d\\.]+)(.*)/;\nfunction getDimPx(dim, length) {\n  var [ whole, size, unit ] = cssUnit.exec(length.toString());\n  unit = unit || 'px';\n  var dunit = dim === 'width' ? 'dwunit' : 'dhunit';\n  var div = this.find('div');\n\n  if (unit === 'px') {\n    return size;\n  } else if (div) {\n    var toSet = {};\n    toSet['geometry.' + dim] = size;\n    toSet['geometry.' + dunit] = unit;\n    this.set(toSet);\n    var v = this.find('div')['client' + dim[0].toUpperCase() + dim.substring(1)];\n    toSet['geometry.' + dim] = v;\n    toSet['geometry.' + dunit] = 'px';\n    this.set(toSet);\n    return v;\n  }\n}\n\nexport default Window;\n"],"names":[],"mappings":"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"}