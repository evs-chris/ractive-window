{"version":3,"file":"index.js","sources":["../src/index.js","../src/host.js","../src/window.js"],"sourcesContent":["import Window from \"window\";\nimport Host from \"host\";\n\nvar res = {\n  \"Window\": Window,\n  \"WindowHost\": Host\n};\n\nexport default res;\n","/* global Ractive */\n\nimport Window from \"window\";\n\nvar messageButtons = {\n  ok: { label: 'OK', action: function() { this.result = 'ok'; this.close(); }, position: 'middle' },\n  cancel: { label: 'Cancel', action: function() { this.result = 'cancel'; this.close(); }, position: 'middle' },\n  yes: { label: 'Yes', action: function() { this.result = 'yes'; this.close(); }, position: 'middle' },\n  no: { label: 'No', action: function() { this.result = 'no'; this.close(); }, position: 'middle' }\n};\n\nvar WindowHost;\nWindowHost = (function() {\n  var counter = 0;\n\n  // creates a window by appending to the slot array and retrieving the added window component\n  // the callback is called first, if supplied\n  // the window is then rendered and has its activate function called, if it has one\n  // the window is then cascaded if it isn't already positioned\n  function newWindow(e, cb) { // e can be an event or the callback. the callback (cb) is optional\n    var current = counter;\n    counter += 1;\n    var host = this;\n    return host.push('windowSlots', current).then(function() {\n      var pr;\n\n      // find the window instance let it know who it is\n      var wnds = host.findAllComponents('Window');\n      var wnd = wnds[wnds.length - 1];\n\n      host.set('windows.' + current, wnd);\n      wnd.parentNumber = current;\n      wnd.set({\n        'geometry.index': 1000 + wnds.length,\n        'geometry.left': -9999,\n        'geometry.top': -9999,\n        'id': current\n      });\n\n      // call the creation callback if given\n      var step1 = function() {\n        var mpr;\n        if (!!cb && typeof(cb) === 'function') {\n          try {\n            mpr = cb(wnd);\n            if (!!mpr && typeof mpr.then === 'function') return mpr;\n          } catch (e1) { console.log(e1); }\n        } else if (typeof(e) === 'function') {\n          try {\n            mpr = e(wnd);\n            if (!!mpr && typeof mpr.then === 'function') pr = mpr;\n          } catch (e2) { console.log(e2); }\n        }\n      };\n      pr = step1();\n\n      // render the window and call its activate function\n      var step2 = function() {\n        var mpr;\n        wnd.raise();\n        return wnd.set('_wnd_rendered', true).then(function() {\n          wnd.element = wnd.find('.ractive-window');\n          try {\n            mpr = wnd.activated();\n            if (!!mpr && typeof mpr.then === 'function') return mpr;\n          } catch (e4) { console.log(e4); }\n        });\n      };\n      if (!!pr) pr = pr.then(step2); else pr = step2();\n\n      // move the window from initial offscreen coordinates\n      var step3 = function() {\n        var mpr;\n        if (wnd.get('geometry.left') === -9999) {\n          return wnd.move('cascade').then(() => wnd);\n        }\n        return wnd;\n      };\n      if (!!pr) pr = pr.then(step3); else pr = step3();\n\n      // return a promise for the last steps completion\n      return pr;\n    });\n  }\n\n  // shows a centered modal messagebox\n  function messageBox(opts) {\n    var args = arguments;\n    var host = this;\n    return new Ractive.Promise(function(y) {\n      host.newWindow(function(w) {\n        var message;\n        if (args.length >= 2) {\n          message = args[0];\n          opts = args[1];\n        } else if (args.length === 1 && typeof args[0] === 'string') {\n          message = args[0];\n          opts = {};\n        }\n\n        w.set('title', opts.title || 'Message');\n        w.set('resizable', false);\n        w.controls('close');\n        w.content(message);\n        var btns = opts.buttons || ['ok'], out = [];\n        for (var i = 0; i < btns.length; i++) if (messageButtons.hasOwnProperty(btns[i])) out.push(messageButtons[btns[i]]);\n        w.buttons(out);\n        w.onClose = function() {\n          this.kill();\n          y(w.result || 'none');\n        };\n        if (!opts.hasOwnProperty('modal') || opts.modal) host.set('globalBlock', w);\n        w.activated = function() { w.move('center'); };\n      });\n    });\n  }\n\n  return Ractive.extend({\n    isolated: true,\n    defaults: {\n      control: {\n        label: function label(control, lbl) { Window.partials[control + 'ControlLabel'] = lbl; }\n      },\n      controls: function() {\n        var partial = '';\n        for (var i = 0; i < arguments.length; i++) {\n          partial += '{{>' + arguments[i] + 'Control}}';\n        }\n        Window.partials.controls = partial;\n      }\n    },\n    components: { Window: Window },\n    data: { windowSlots: [], windows: {}, blocks: {}, globalBlock: null },\n    computed: { blocked: function() { return !!this.get('globalBlock'); } },\n    template: \"<div class='ractive-window-host-modal' style='{{^blocked}}display: none;{{/blocked}}'></div><div class='host-content'>{{yield}}</div>{{#windowSlots}}<Window/>{{/windowSlots}}\",\n    newWindow: newWindow,\n    killWindow: function(wnd) {\n      var blocks = this.get('blocks');\n      var wnds = this.get('windows');\n      var topWnd, topIdx = -1, i;\n      if (!!wnds) {\n        for (var w in wnds) {\n          if (wnds[w] === wnd) delete wnds[w];\n          else {\n            i = wnds[w].get('geometry.index');\n            if (i > topIdx) {\n              topIdx = i;\n              topWnd = wnds[w];\n            }\n          }\n        }\n        if (topWnd && !topWnd.get('topmost')) topWnd.set('topmost', true);\n      }\n      var slots = this.get('windowSlots');\n      if (!!slots) {\n        this.splice('windowSlots', slots.indexOf(wnd.parentNumber), 1);\n      }\n      for (i in blocks) {\n        var arr = blocks[i];\n        if (!!arr && Array.isArray(arr) && arr.indexOf(wnd.parentNumber) >= 0) arr.splice(arr.indexOf(wnd.parentNumber), 1);\n      }\n      if (wnd === this.get('globalBlock')) this.set('globalBlock', null);\n      this.unblockUnblockedWindows();\n    },\n    raiseWindow: function(wnd) {\n      var wndso = this.get('windows');\n      var slots = this.get('windowSlots');\n      var blocks = this.get('blocks');\n      var wnds = [];\n      var target = this.topLevelBlockers(wnd);\n      target.push(wnd);\n\n      for (var k in wndso) if (target.indexOf(wndso[k]) < 0) wnds.push(wndso[k]);\n\n      // put windows in existing order in an array\n      wnds.sort(function(a, b) {\n        var ai = a.get('geometry.index'), bi = b.get('geometry.index');\n        if (ai < bi) return -1; else if (ai > bi) return 1; else return 0;\n      });\n\n      // add the window being raised to the end-o-the-queue\n      if (!!wnd) wnds = wnds.concat(target);\n\n      // move blocked windows to below their blocker with splice and indexOf\n      function moveBeforeBlocker(wnd, blockers) {\n        for (var i in blockers) {\n          var bl = wndso[blockers[i]];\n          var wi = wnds.indexOf(wnd), bi = wnds.indexOf(bl);\n          if (!!!bl || wi < 0 || bi < 0) continue;\n\n          // blocker must be moved first in case it too is blocked, so recursion required\n          var arr = blocks[bl.parentNumber];\n          if (!!!arr && Array.isArray(arr) && arr.length > 0) moveBeforeBlocker(bl, arr);\n          if (wi > bi) {\n            wnds.splice(wi, 1); // remove window\n            wnds.splice(bi, 0, wnd); // pop it in before bl\n          }\n        }\n      }\n\n      var i;\n      for (i in slots) {\n        var arr = blocks[slots[i]];\n        if (!!arr && Array.isArray(arr) && arr.length > 0) moveBeforeBlocker(wndso[slots[i]], arr);\n      }\n\n      // loop through array assigning indices\n      for (i in wnds) {\n        wnds[i].set('geometry.index', 1000 + (+i));\n        if (wnds[i] !== wnd) wnds[i].set('topmost', false);\n      }\n      if (!wnd.get('topmost')) wnd.set('topmost', true);\n\n      function globalBlocks(wnd) {\n        var res = [];\n        if (!!!wnd) return res;\n\n        var arr = blocks[wnd.parentNumber];\n        if (!!arr && Array.isArray(arr) && arr.length > 0) {\n          for (var i in arr) {\n            res = res.concat(globalBlocks(wndso[arr[i]]));\n          }\n        }\n\n        res.push(wnd);\n\n        return res;\n      }\n\n      // if globalBlock is set, add 10000 to it and all of its blockers\n      var globals = globalBlocks(this.get('globalBlock'));\n      for (i in globals) globals[i].add('geometry.index', 10000);\n    },\n    topLevelBlockers: function(wnd) {\n      if (!!!wnd) return [];\n\n      var blocks = this.get('blocks');\n      var wndso = this.get('windows');\n      var arr = blocks[wnd.parentNumber];\n      var res = [];\n\n      if (!!!arr || !Array.isArray(arr) || arr.length === 0) return res;\n\n      for (var i in arr) {\n        var arr2 = blocks[arr[i]];\n        if (!!!arr2 || !Array.isArray(arr2) || arr2.length === 0) res.push(wndso[arr[i]]);\n        else {\n          res = res.concat(this.topLevelBlockers(wndso[arr[i]]));\n        }\n      }\n\n      return res;\n    },\n    blockWindow: function(target, blocker /*, ...*/) {\n      if (!!!target || !!!blocker) return;\n\n      var blocks = this.get('blocks');\n      var arr = blocks[target.parentNumber];\n      if (!!!arr || !Array.isArray(arr)) arr = [];\n      if (arr.indexOf(blocker.parentNumber) < 0) arr.push(blocker.parentNumber);\n      blocks[target.parentNumber] = arr;\n      for (var i = 2; i < arguments.length; i++) {\n        if (arr.indexOf(arguments[i].parentNumber) < 0) arr.push(arguments[i].parentNumber);\n      }\n      if (arr.length > 0) target.set('blocked', true);\n      this.raiseWindow();\n    },\n    unblockWindow: function(target, blocker /*, ...*/) {\n      if (!!!target | !!!blocker) return;\n\n      var blocks = this.get('blocks');\n      var arr = blocks[target.parentNumber];\n      if (!!!arr || !Array.isArray(arr)) return;\n      if (arr.indexOf(blocker.parentNumber) >= 0) arr.splice(arr.indexOf(blocker.parentNumber), 1);\n      for (var i = 2; i < arguments.length; i++) {\n        if (arr.indexOf(arguments[i].parentNumber) >= 0) arr.splice(arr.indexOf(arguments[i].parentNumber), 1);\n      }\n      if (arr.length === 0) target.set('blocked', false);\n      this.raiseWindow();\n    },\n    unblockUnblockedWindows: function() {\n      var blocks = this.get('blocks');\n      var wndso = this.get('windows');\n      for (var i in blocks) {\n        var arr = blocks[i];\n        if (!!!arr || !Array.isArray(arr) || arr.length === 0) {\n          var wnd = wndso[i];\n          if (!!wnd) wnd.set('blocked', false);\n        }\n      }\n    },\n    messageBox: messageBox\n  });\n})();\n\nexport default WindowHost;\n","/* global Ractive */\n\nvar template =\n`{{#_wnd_rendered}}<div id='ractive-window-{{.id}}' class='ractive-window{{#(.buttons.length > 0)}} with-buttons{{/}}{{#.resizable}} resizable{{else}} fixed{{/}}{{#.geometry.state === 2}} maximized{{/}}{{#.class.window}} {{.class.window}}{{/}}{{#.topmost}} topmost{{/}}' on-click='_raise' style='{{#.hidden}}display: none;{{/}}top: {{.geometry.top}}px; left: {{.geometry.left}}px; {{#(.resizable || .geometry.state === 2)}}width: {{.geometry.width}}{{.geometry.dwunit}}; height: {{.geometry.height}}{{.geometry.dhunit}}; {{/}}z-index: {{.geometry.index}};{{#.style.window}} {{.style.window}}{{/}}'>\n  <div class='rw-modal' on-mousedown='_moveStart' style='{{^.blocked}}display: none;{{/}}'></div>\n  <div class='rw-interior'>\n    <div class='rw-controls'>{{>controls}}</div>\n    <div class='rw-title' on-touchstart-mousedown='_moveStart' on-dblclick='_restore'>{{>title}}</div>\n    <div class='rw-body{{#.class.body}} {{.class.body}}{{/}}' {{#.style.body}}style='{{.style.body}}'{{/}}>{{>body}}</div>\n    {{#(.buttons.length > 0)}}<div class='rw-buttons'>{{>buttons}}</div>{{/}}\n    <div class='rw-resize-handle' on-touchstart-mousedown='_resizeStart'></div>\n    <div class='rw-foot'>{{>foot}}</div>\n  </div>\n</div>{{/}}`;\n\nvar Window;\nWindow = Ractive.extend({\n  template: template,\n  onconstruct: function(opts) {\n    var wnd = this;\n\n    var sx, sy;\n    var moveFn;\n    moveFn = function(e) {\n      var x, y;\n      e.preventDefault();\n      if (e.type.indexOf('touch') >= 0) {\n        x = +(e.changedTouches[0].clientX);\n        y = +(e.changedTouches[0].clientY);\n      } else {\n        x = +(e.x || e.clientX);\n        y = +(e.y || e.clientY);\n      }\n\n      wnd.move(+wnd.get('geometry.left') + x - +sx, +wnd.get('geometry.top') + y - +sy);\n      sx = x;\n      sy = y;\n      if (e.type === 'mouseup' || e.type === 'touchend') {\n        document.removeEventListener('mousemove', moveFn, false);\n        document.removeEventListener('mouseup', moveFn, false);\n        document.removeEventListener('touchmove', moveFn, false);\n        document.removeEventListener('touchend', moveFn, false);\n      }\n    };\n    wnd.on('_moveStart', function(e) {\n      if ((e.original.type === 'mousedown' && e.original.button === 0) || e.original.type === 'touchstart') {\n        wnd.restore();\n        if (e.original.type.indexOf('touch') >= 0) {\n          sx = +(e.original.changedTouches[0].clientX);\n          sy = +(e.original.changedTouches[0].clientY);\n        } else {\n          sx = +(e.original.x || e.original.clientX);\n          sy = +(e.original.y || e.original.clientY);\n        }\n        document.addEventListener('mousemove', moveFn);\n        document.addEventListener('mouseup', moveFn);\n        document.addEventListener('touchmove', moveFn);\n        document.addEventListener('touchend', moveFn);\n        e.original.preventDefault();\n      }\n    });\n\n    var resizeFn;\n    resizeFn = function(e) {\n      var x, y;\n      e.preventDefault();\n      if (e.type.indexOf('touch') >= 0) {\n        x = e.changedTouches[0].clientX;\n        y = e.changedTouches[0].clientY;\n      } else {\n        x = +(e.x || e.clientX);\n        y = +(e.y || e.clientY);\n      }\n      var w = +wnd.get('geometry.width') + (x - +sx);\n      var h = +wnd.get('geometry.height') + (y - +sy);\n      wnd.resize(w, h);\n      sx = x;\n      sy = y;\n      if (e.type === 'mouseup' || e.type === 'touchend') {\n        document.removeEventListener('mousemove', resizeFn, false);\n        document.removeEventListener('mouseup', resizeFn, false);\n        document.removeEventListener('touchmove', resizeFn, false);\n        document.removeEventListener('touchend', resizeFn, false);\n      }\n    };\n    wnd.on('_resizeStart', function(e) {\n      if ((e.original.type == 'mousedown' && e.original.button === 0) || e.original.type === 'touchstart') {\n        wnd.restore();\n        if (e.original.type.indexOf('touch') >= 0) {\n          sx = e.original.changedTouches[0].clientX;\n          sy = e.original.changedTouches[0].clientY;\n        } else {\n          sx = (e.original.x || e.original.clientX);\n          sy = (e.original.y || e.original.clientY);\n        }\n        document.addEventListener('mousemove', resizeFn);\n        document.addEventListener('mouseup', resizeFn);\n        document.addEventListener('touchmove', resizeFn);\n        document.addEventListener('touchend', resizeFn);\n      }\n    });\n\n    var stateFn = function(target, e) {\n      switch (target) {\n        case 'min': wnd.minimize(); break;\n        case 'max': wnd.maximize(); break;\n        case 'normal': wnd.restore(); break;\n        default: break;\n      }\n    };\n\n    wnd.on('_minimize', function(e) { stateFn('min', e); });\n    wnd.on('_restore', function(e) {\n      switch (wnd.get('geometry.state')) {\n        case 0: stateFn('max', e); break;\n        case 1:\n          case 2:\n          stateFn('normal', e); break;\n        default: break;\n      }\n    });\n    wnd.on('_raise', function(e) { wnd.raise(); });\n    wnd.on('_close', function(e) { wnd.close(); });\n    wnd.on('_dialog-button', function(e) {\n      var fn = e.context.action;\n      if (!!fn && typeof fn === 'function') fn.call(this);\n    });\n\n    wnd.result = null;\n    wnd.waitForClose = wnd.afterClose = new Ractive.Promise(function(y, n) {\n      var fn = function(t) {\n        return function(v) {\n          wnd.completeAfterClose = null;\n          wnd.rejectAfterClose = null;\n          t(v);\n        };\n      };\n      wnd.completeAfterClose = fn(y);\n      wnd.rejectAfterClose = fn(n);\n    });\n  },\n  onrender() {\n    if (!!!this.get('buttonClass') && !!this.parent.get('buttonClass')) {\n      this.set('buttonClass', this.parent.get('buttonClass'));\n    }\n\n    this.watchers = this.observe({\n      title: (n, o) => {\n        this.fire('retitle', n, this);\n      },\n\n      'geometry.state': (n, o) => {\n        switch (n) {\n          case 0: this.fire('restore', n, this); break;\n          case 1: this.fire('minimize', n, this); break;\n          case 2: this.fire('maximize', n, this); break;\n        }\n      }\n    });\n  },\n  onunrender() { if (this.watchers && typeof this.watchers.cancel === 'function') this.watchers.cancel(); },\n  activated() {},\n  data() { return {\n    _wnd_rendered: false,\n    blocked: false,\n    resizable: true,\n    geometry: {\n      top: -9999, left: -9999, width: 200, height: 200, state: 0, dwunit: 'px', dhunit: 'px', index: 1000,\n      minimum: { x: 0, y: 0, width: 70, height: 50 }\n    },\n    style: {},\n    class: {},\n    makePartial(key, template) {\n      if (!this._makePartial_templates) this._makePartial_templates = {};\n      if (this._makePartial_templates[key] != template) {\n        this.resetPartial(key, template);\n        this._makePartial_templates[key] = template;\n      }\n      return key;\n    }\n  }; },\n  partials: {\n    title: \"{{> ~/makePartial('titleTpl', .title) }}\",\n    body: '',\n    foot: '',\n    buttons: \"{{#.buttons:i}}<button on-click='_dialog-button' class='{{.position || ''}}{{#.buttonClass}} {{.buttonClass}}{{/}}{{#../../class.button}} {{../../class.button}}{{/}}' disabled='{{!.enabled}}'>{{> ~/makePartial('button' + i + 'Tpl', .label) }}</button>{{/}}\",\n    controls: '{{>minimizeControl}}{{>restoreControl}}{{>closeControl}}',\n    minimizeControl: \"<button on-click='_minimize' class='rw-minimize'>{{>minimizeControlLabel}}</button>\",\n    minimizeControlLabel: \"_\",\n    restoreControl: \"<button on-click='_restore' class='rw-restore'>{{>restoreControlLabel}}</button>\",\n    restoreControlLabel: \"^\",\n    closeControl: \"<button on-click='_close' class='rw-close'>{{>closeControlLabel}}</button>\",\n    closeControlLabel: \"X\"\n  },\n  rerender: function() {\n    var wnd = this;\n    if (!wnd.get('_wnd_rendered')) return Ractive.Promise.resolve('ok');\n    wnd.set('_wnd_rendered', false);\n    return this.set('_wnd_rendered', true);\n  },\n  title: function(str) { this.set('title', str); },\n  move: function(x, y) {\n    if (typeof x === 'string') {\n      switch (x) {\n        case 'center':\n          case 'centerScreen':\n          return this.set({\n          'geometry.top': (this.parent.el.clientHeight - this.element.clientHeight) / 2,\n          'geometry.left': (this.parent.el.clientWidth - this.element.clientWidth) / 2\n        });\n        case 'cascade':\n          return this.set({\n          'geometry.top': ((this.parentNumber % 10) * 20) + 10,\n          'geometry.left': ((this.parentNumber % 50) * 20) + 10\n        });\n      }\n      return Ractive.Promise.resolve(false);\n    }\n    y = +y;\n    x = +x;\n    var min = this.get('geometry.minimum');\n    var max = this.get('geometry.maximum');\n    var w = +this.get('geometry.width');\n    var h = +this.get('geometry.height');\n    if (!!max) {\n      if (x + w > +max.x) x = +max.x - x;\n      if (y + h > +max.y) y = +max.y - y;\n    }\n    if (!!min) {\n      if (x < +min.x) x = +min.x;\n      if (y < +min.y) y = +min.y;\n    }\n    return this.set({\n      'geometry.top': y,\n      'geometry.left': x\n    });\n  },\n  resize: function(w, h) {\n    w = getDimPx.call(this,'width', w);\n    h = getDimPx.call(this, 'height', h);\n    var min = this.get('geometry.minimum');\n    var max = this.get('geometry.maximum');\n    if (!!max) {\n      if (w > max.width) w = max.width;\n      if (w > max.height) w = max.height;\n    }\n    if (!!min) {\n      if (w < min.width) w = min.width;\n      if (h < min.height) h = min.height;\n    }\n    this.set({\n      'geometry.width': w,\n      'geometry.height': h\n    });\n  },\n  resizable: function(b) { this.set('resizable', b); },\n  minimize: function() {\n    var wnd = this;\n    if (wnd.get('geometry.state') !== 1) {\n      wnd.set({\n        hidden: true,\n        'geometry.state': 1\n      });\n      wnd.fire('minimized', { window: wnd });\n    }\n  },\n  maximize: function() {\n    var wnd = this;\n    if (wnd.get('geometry.state') !== 2) {\n      wnd.normalGeometry = { top: wnd.get('geometry.top'), left: wnd.get('geometry.left'), width: wnd.get('geometry.width'), height: wnd.get('geometry.height') };\n      wnd.set({\n        'hidden': false,\n        'geometry.left': 0,\n        'geometry.top': 0,\n        'geometry.width': 100,\n        'geometry.height': 100,\n        'geometry.dwunit': '%',\n        'geometry.dhunit': '%',\n        'geometry.state': 2\n      });\n      wnd.fire('maximized', { window: wnd });\n    }\n  },\n  restore: function() {\n    var wnd = this;\n    switch (wnd.get('geometry.state')) {\n      case 1: // minimized\n        wnd.set({\n          hidden: false,\n          'geometry.state': 0\n        });\n        break;\n      case 2:\n        var g = wnd.normalGeometry || {};\n        wnd.normalGeometry = null;\n        if (g.top < 0 || g.left < 0) {\n          g.top = 0;\n          g.left = 0;\n        }\n        wnd.set({\n          hidden: false,\n          'geometry.left': g.left,\n          'geometry.top': g.top,\n          'geometry.width': g.width,\n          'geometry.height': g.height,\n          'geometry.dwunit': 'px',\n          'geometry.dhunit': 'px',\n          'geometry.state': 0\n        });\n        break;\n      default: break;\n    }\n    this.raise();\n  },\n  raise: function() {\n    if (!!this.parent) this.parent.raiseWindow(this);\n  },\n  kill: function() {\n    var wnd = this;\n    this.fire('close', this);\n    if (!!wnd.parent) {\n      wnd.parent.killWindow(wnd);\n    } else {\n      wnd.teardown();\n    }\n    if (!!wnd.completeAfterClose) wnd.completeAfterClose(wnd.result);\n  },\n  content: function(ct) {\n    return this.resetPartial('body', ct);\n  },\n  buttons: function() {\n    var arr = [], i;\n    this.set('buttons', arr);\n    if (arguments.length === 1 && typeof arguments[0].length === 'number') {\n      arr = arguments[0];\n    } else {\n      for (i = 0; i < arguments.length; i++) {\n        arr.push(arguments[i]);\n      }\n    }\n    var left = [], right = [], middle = [];\n    for (i = 0; i < arr.length; i++) {\n      var b = arr[i];\n      if (!!b.position) {\n        if (b.position === 'left') left.push(b);\n        else if (b.position === 'right') right.push(b);\n        else if (b.position === 'middle') middle.push(b);\n        else if (b.position === 'center') middle.push(b);\n        else { right.push(b); b.position = 'right'; }\n      } else { right.push(b); b.position = 'right'; }\n      if (!b.hasOwnProperty('enabled')) b.enabled = true;\n    }\n    arr = [];\n    for (i = 0; i < left.length; i++) arr.push(left[i]);\n    for (i = right.length - 1; i >= 0; i--) arr.push(right[i]);\n    for (i = 0; i < middle.length; i++) arr.push(middle[i]);\n    this.set('buttons', arr);\n  },\n  button: function(name, cb) {\n    var arr = this.get('buttons');\n    var btn, i;\n    if (typeof name === 'number') { btn = arr[name]; i = name; }\n    else for (i = 0; i < arr.length; i++) {\n      if (arr[i].label === name) {\n        btn = arr[i];\n        break;\n      }\n    }\n\n    if (!!btn) {\n      cb(btn);\n      this.set('buttons.' + i, btn);\n    }\n  },\n  controls: function() {\n    var arr = [], i, str = '';\n    if (arguments.length === 1 && typeof arguments[0] !== 'string') arr = arguments[0];\n    else {\n      for (i = 0; i < arguments.length; i++) arr.push(arguments[i]);\n    }\n    for (i = 0; i < arr.length; i++) str += '{{>' + arr[i] + 'Control}}';\n    this.partials.controls = str;\n    return this.rerender();\n  },\n  onClose: function() {\n    this.kill();\n  },\n  close: function(fn) {\n    if (!!!fn) fn = this.onClose;\n    if (fn.length === 0) fn.call(this);\n    else {\n      var wnd = this;\n      fn.call(this, function(close) { if (close) wnd.kill(); });\n    }\n  }\n});\n\nvar cssUnit = /([\\d\\.]+)(.*)/;\nfunction getDimPx(dim, length) {\n  var [ whole, size, unit ] = cssUnit.exec(length.toString());\n  unit = unit || 'px';\n  var dunit = dim === 'width' ? 'dwunit' : 'dhunit';\n  var div = this.find('div');\n\n  if (unit === 'px') {\n    return size;\n  } else if (div) {\n    var toSet = {};\n    toSet['geometry.' + dim] = size;\n    toSet['geometry.' + dunit] = unit;\n    this.set(toSet);\n    var v = this.find('div')['client' + dim[0].toUpperCase() + dim.substring(1)];\n    toSet['geometry.' + dim] = v;\n    toSet['geometry.' + dunit] = 'px';\n    this.set(toSet);\n    return v;\n  }\n}\n\nexport default Window;\n"],"names":[],"mappings":"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"}